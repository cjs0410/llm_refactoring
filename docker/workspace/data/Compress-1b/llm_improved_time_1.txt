public void close() throws IOException {
    if (!this.closed) {
        finishAndClose();
    }
}

private void finishAndClose() throws IOException {
    this.finish();
    super.close();
    this.closed = true;
}