 int readEscape() throws IOException {
        // the escape char has just been read (normally a backslash)
        final int c = in.read();
        switch (c) {
            case 'r', 'n', 't', 'b', 'f' -> {
                switch (c) {
                    case 'r' -> return CR;
                    case 'n' -> return LF;
                    case 't' -> return TAB;
                    case 'b' -> return BACKSPACE;
                    case 'f' -> return FF;
                }
            }
            case CR, LF, FF, TAB, BACKSPACE -> return c;
            case END_OF_STREAM -> throw new IOException("EOF whilst processing escape sequence");
            default -> {
                if (isDelimiter(c) || isEscape(c) || isQuoteChar(c) || isCommentStart(c)) {
                    return c;
                } else {
                    return END_OF_STREAM;
                }
            }
        }
    }