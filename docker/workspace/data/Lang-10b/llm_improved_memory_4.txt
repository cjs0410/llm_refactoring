private static StringBuilder escapeRegex(StringBuilder regex, String value, boolean unquote) {
    char[] charArray = value.toCharArray();
    for (int i = 0; i < charArray.length; ++i) {
        char c = charArray[i];
        switch (c) {
            case '\'':
                if (unquote) {
                    if (++i == charArray.length) {
                        return regex;
                    }
                    c = charArray[i];
                }
                break;
            case '?':
            case '[':
            case ']':
            case '(':
            case ')':
            case '{':
            case '}':
            case '\\':
            case '|':
            case '*':
            case '+':
            case '^':
            case '$':
            case '.':
                regex.append('\\');
        }
        regex.append(c);
    }
    return regex;
}